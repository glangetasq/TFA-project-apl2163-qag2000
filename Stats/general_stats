from django.http import HttpResponse, HttpResponseRedirect
from django.shortcuts import render, get_object_or_404,redirect
from django.urls import  reverse_lazy
from django.views.generic.edit import UpdateView,DeleteView,CreateView
from django.db.models import Count

from .models import SquirrelSighting

def stats(request):
    squirrel_list = SquirrelSighting.objects.all()
    TotalNumber = len(squirrel_list)
    Run% = list(squirrel_list.values_list('Run').annotate(Count('Run'))/len(squirrel_list))
    Chase% = list(squirrel_list.values_list('Chase').annotate(Count('Chase'))/len(squirrel_list))
    Climb% = list(squirrel_list.values_list('Climb').annotate(Count('Climb'))/len(squirrel_list))
    Eat% = list(squirrel_list.values_list('Eat').annotate(Count('Eat'))/len(squirrel_list))
    Forage% = list(squirrel_list.values_list('Forage').annotate(Count('Forage'))/len(squirrel_list))
    context = {
        'stats':{'TotalNumber':TotalNumber,
                'Run%':Run%,
                'Chase%':Chase%,
                'Climb%':Climb%,
                'Eat%':Eat%,
                'Forage%':Forage%,},
    }
    return render(request, 'st/stats.html', context)
